<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Agile Ruby on Rails Development and Consulting Company | WebHouse &mdash; How to install Ruby on Rails application on Ubuntu</title>
  <meta name="description" content="I’ll describe the process how to install Ruby on Rails application on Ubuntu from scratch.But firstly we have to prepare our server for application.">
  <meta name="keywords" content="Ruby web development, Web development, agile Ruby development, Ruby on Rails web design, RoR consulting, Ruby on Rails service, RoR consultant, Ruby on Rails NYC, Ruby on Rails expertise, Software Engineer SF, web agency, ios application development, mobile, api, frontend, backend, development, software engineer partner">
  <meta name="author" content="Max Lukin">

  <link rel="canonical" href="http://localhost:4000/blog/how-to-install-ruby-on-rails-application-on-ubuntu">
  <link rel="alternate" type="application/rss+xml" title="Agile Ruby on Rails Development and Consulting Company | WebHouse" href="http://localhost:4000/feed.xml" />
  <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png">

  <!-- Main CSS -->
  <link rel="stylesheet" href="/css/main.css">

  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>

  <body>
      <header>
        <nav class="light-blue lighten-1" role="navigation">
          <div class="nav-wrapper container">
            <a id="logo-container" href="/" class="brand-logo">WebHouse</a>
            <a href="#" data-target="mobile-demo" class="sidenav-trigger">
              <i class="material-icons">menu</i>
            </a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
              <li><a href="/">Main</a></li>
              <li><a href="technology.html">Technology we use</a></li>
              <li><a href="whatwedo.html">What we do</a></li>
              <!-- <li><a href="about.html">About</a></li>
              <li><a href="works.html">Works</a></li> -->
              <li><a href="contacts.html">Contacts</a></li>
            </ul>
          </div>
        </nav>

        <ul class="sidenav" id="mobile-demo">
          <li><a href="/">Main</a></li>
          <li><a href="technology.html">Technology we use</a></li>
          <li><a href="whatwedo.html">What we do</a></li>
          <!-- <li><a href="about.html">About</a></li>
          <li><a href="works.html">Works</a></li> -->
          <li><a href="contacts.html">Contacts</a></li>
        </ul>

      </header>
      <main>
        <div class="post-template">
  <h4><a href="/">< back</a></h4>

  <div class="cleafix"><br/></div>
  <div>
    <kbd>By <b>Max Lukin</b> on Oct 21, 2015</kbd>
    <h4><a class="post-link" href="#">How to install Ruby on Rails application on Ubuntu</a></h4>
  </div>

  <hr />

  <div><p>I’ll describe the process how to install Ruby on Rails application on Ubuntu from scratch.
But firstly we have to prepare our server for application.</p>

<p>We will use DigitalOcean.
There’s a lot of kinds of droplets, Ruby on Rails included, and clean images based on Ubuntu and etc.
I prefer image with Ruby on Rails.</p>

<p>For the first, add your public SSH key for DigitalOcean, just copy it locally like:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">cat</span> ~/.ssh/id_rsa.pub| pbcopy <span class="c"># pbcopy is mac utility that allow you to copy text from console.:</span></code></pre></figure>

<p>Then put it to your DO profile.</p>

<p>First ssh connection will ask you for change password:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>passwd</code></pre></figure>

<p>Then we have to add user, which will be responsile for deploying our application:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>adduser deployer</code></pre></figure>

<p>And we’ll add him all privileges:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>visudo
<span class="nv">$ </span>deployer <span class="nv">ALL</span><span class="o">=(</span>ALL:ALL<span class="o">)</span> ALL</code></pre></figure>

<p>This is it for now, le’ts move to another part - software!
Let’s start from RVM, ad install it:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>gpg <span class="nt">--keyserver</span> hkp://keys.gnupg.net <span class="nt">--recv-keys</span> 409B6B1796C275462A1703113804BB82D39DC0E3
<span class="nv">$ </span>curl <span class="nt">-sSL</span> https://get.rvm.io | bash <span class="nt">-s</span> stable
<span class="nv">$ </span><span class="nb">source</span> /etc/profile.d/rvm.sh
<span class="nv">$ </span>rvm requirements
<span class="nv">$ </span>rvm <span class="nb">install </span>2.2.2 <span class="nt">--default</span></code></pre></figure>

<p>Last postgresql version:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"deb http://apt.postgresql.org/pub/repos/apt/ trusty-pgdg main"</span> <span class="o">&gt;</span> /etc/apt/sources.list.d/pgdg.list
<span class="nv">$ </span>wget <span class="nt">--quiet</span> <span class="nt">-O</span> - https://www.postgresql.org/media/keys/ACCC4CF8.asc | <span class="se">\ </span><span class="nb">sudo </span>apt-key add -
<span class="nv">$ </span><span class="nb">sudo </span>apt-get update
<span class="nv">$ </span><span class="nb">sudo </span>apt-get <span class="nb">install </span>postgresql postgresql-server-dev-9.4 <span class="nt">-y</span></code></pre></figure>

<p>Let’s to allow any connections to our postgresql from localhost:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>nano /etc/postgresql/9.4/main/pg_hba.conf</code></pre></figure>

<p>And replace some configs inside:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">local </span>all postgres trust
<span class="nb">local </span>all all trust</code></pre></figure>

<p>Then, restart our postgres server:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span><span class="nb">sudo </span>service postgresql restart</code></pre></figure>

<p>Settings password for root user for our DB, and create database for blog:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">sudo</span> <span class="nt">-u</span> postgres psql template1</code></pre></figure>

<figure class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">ALTER</span> <span class="k">USER</span> <span class="n">postgres</span> <span class="k">with</span> <span class="k">encrypted</span> <span class="n">password</span> <span class="s1">'po$tgr3$$'</span><span class="p">;</span>
<span class="k">create</span> <span class="k">database</span> <span class="n">webhouse_production</span><span class="p">;</span></code></pre></figure>

<p>Other sofr - Git, Node.js:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">sudo </span>apt-get <span class="nb">install </span>git-core nodejs <span class="nt">-y</span></code></pre></figure>

<p>In case of our image that included Ruby on Rails, we already have some nginx configs for Rails:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nv">$ </span>nano /etc/nginx/sites-available/rails</code></pre></figure>

<p>And nginx config will look like:</p>

<figure class="highlight"><pre><code class="language-nginx" data-lang="nginx"><span class="k">upstream</span> <span class="s">app_server</span> <span class="p">{</span>
  <span class="kn">server</span> <span class="s">unix:///home/rails/shared/tmp/sockets/puma.sock</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">server</span> <span class="p">{</span>
        <span class="kn">listen</span>   <span class="mi">80</span><span class="p">;</span>
        <span class="kn">root</span> <span class="n">/home/rails/current/public</span><span class="p">;</span>
        <span class="kn">server_name</span> <span class="s">webhouse.dev</span><span class="p">;</span>
        <span class="kn">index</span> <span class="s">index.htm</span> <span class="s">index.html</span><span class="p">;</span>

        <span class="kn">location</span> <span class="n">/</span> <span class="p">{</span>
                <span class="kn">try_files</span> <span class="nv">$uri</span><span class="n">/index.html</span> <span class="nv">$uri</span><span class="s">.html</span> <span class="nv">$uri</span> <span class="s">@app</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="kn">location</span> <span class="p">~</span><span class="sr">*</span> <span class="s">^.+</span><span class="err">\</span><span class="s">.(jpg|jpeg|gif|png|ico|zip|tgz|gz|rar|bz2|doc|xls|exe|pdf|ppt|txt|tar|mid|midi|wav|bmp|rtf|mp3|flv|mpeg|avi)</span>$ <span class="p">{</span>
                        <span class="kn">try_files</span> <span class="nv">$uri</span> <span class="s">@app</span><span class="p">;</span>
                <span class="p">}</span>

         <span class="kn">location</span> <span class="s">@app</span> <span class="p">{</span>
                <span class="kn">proxy_set_header</span> <span class="s">X-Forwarded-For</span> <span class="nv">$proxy_add_x_forwarded_for</span><span class="p">;</span>
                <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$http_host</span><span class="p">;</span>
                <span class="kn">proxy_redirect</span> <span class="no">off</span><span class="p">;</span>
                <span class="kn">proxy_pass</span> <span class="s">http://app_server</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>We’ll just create symlink and make this site config enabled:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="nb">sudo ln</span> <span class="nt">-sf</span> /etc/nginx/sites-available/rails /etc/nginx/sites-enabled/rails
<span class="nb">sudo </span>service nginx restart</code></pre></figure>

<p>If you have any questions - just ping us for help.</p>
</div>


    <div class="twelve columns post-content">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'customgears'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
<script id="dsq-count-scr" src="//customgears.disqus.com/count.js" async></script>


</div>

      </main>
      <footer class="page-footer white">
        <!-- <div class="container">
  <div class="row">

    <div class="col l6 s12">
      <h5 class="white-text">&nbsp;</h5>
      <p class="grey-text text-lighten-4">&nbsp;</p>
    </div>

    <div class="col l4 offset-l2 s12">
      <h5 class="white-text">Contacts</h5>
      <ul>
        <li><a class="grey-text text-lighten-3" href="#!">+38 (063) 765-49-17</a></li>
        <li><a class="grey-text text-lighten-3" href="#!">lukin.maksim@gmail.com</a></li>
      </ul>
    </div>
  </div>
</div> -->

<div class="footer-copyright orange">
  <div class="container center">
    © 2019 WebHouse, <a class="grey-text text-lighten-4" href="/" alt="Agile web development">agile web development</a>
  </div>
</div>

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-68680443-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

<!-- Latest compiled and minified JavaScript -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

      </footer>
  </body>
</html>
